<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>VAN Bookmarklets
	</title>
	<style>
		a {margin:5px;
    text-decoration: none; font: menu;
    display: inline-block; padding: 2px 8px;
    background: ButtonFace; color: ButtonText;
    border-style: solid; border-width: 2px;
    border-color: ButtonHighlight ButtonShadow ButtonShadow ButtonHighlight;
    border-radius: 5px;
    -webkit-touch-callout: none; /* iOS Safari */
    -webkit-user-select: none; /* Safari */
     -khtml-user-select: none; /* Konqueror HTML */
       -moz-user-select: none; /* Old versions of Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
            user-select: none; /* Non-prefixed version, currently
		}
	</style>
	</head>
<body>


<p>
Drag "Buttons" to your bookmarks bar:</p>
<P><a draggable="true" href="javascript:(function(){try{let eventId=322475;let targetOrigin=&quot;https://www.mobilize.us&quot;,targetUrl=targetOrigin+&quot;/nvdems/event/&quot;+eventId+&quot;/&quot;,page=window.location.href,matches=page.match(/https:\/\/www\.(votebuilder.com\/(?:ContactsDetails|ContactDetailScript)|openvpb.com\/VirtualPhoneBank)/);let xpath=(xpathStr,root)=>{return document.evaluate(xpathStr,root||document,null,XPathResult.STRING_TYPE).stringValue};if(matches){let sitesxpaths={&quot;votebuilder.com/ContactDetailScript&quot;:{name:['//div[@class=&quot;person-phone-panel&quot;]/h1/span',/^(.*?) –.*/],email:['//*[contains(@id,&quot;EMailEmail_0&quot;)]'],phone:['//h1[@id=&quot;current-number&quot;]'],zip:['//span[@id=&quot;spanTableAdditionalInfo&quot;]//label[contains(.,&quot;Zip&quot;)]/following-sibling::div|//a[contains(@id,&quot;AddressesAddress&quot;)]',/.*\b(\d{5})(?:\D|$).*|.*/]},&quot;votebuilder.com/ContactsDetails&quot;:{name:['//*[contains(@id,&quot;ContactFullName&quot;)]'],email:['//span[@class=&quot;details-info-text&quot;]/a[contains(@id,&quot;EmailAddress&quot;)]'],phone:['//span[@class=&quot;details-info-text&quot;]/a[contains(@id,&quot;PhoneNumber&quot;)]'],zip:['//span[contains(@class,&quot;glyphicons-map-marker&quot;)]/..//a',/.*\b(\d{5})(?:\D|$).*|.*/]},&quot;openvpb.com/VirtualPhoneBank&quot;:{name:['//*[@id=&quot;contactName&quot;]'],email:['//*[@id=&quot;email-address-input&quot;]/@value'],phone:['//*[@id=&quot;openVpbPhoneLink&quot;]'],zip:['//*[@id=&quot;openvpb-target-details&quot;]//dt[contains(.,&quot;Zip&quot;)]/following-sibling::dd',/.*\b(\d{5})(?:\D|$).*|.*/]}};let xpaths=sitesxpaths[matches[1]];let values={};for(let key in xpaths){let[xp,repl]=xpaths[key];let val=xpath(xp).trim();if(repl)val=val.replace(repl,&quot;$1&quot;).trim();if(key==&quot;name&quot;){let parts=val.split(&quot; &quot;);values[&quot;firstName&quot;]=parts[0];values[&quot;lastName&quot;]=parts[parts.length-1]}else values[key]=val}window.addEventListener(&quot;message&quot;,function(msg){if(msg.origin==targetOrigin)msg.source.postMessage({contact_info:values},targetOrigin)});setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},100)}else if(page.indexOf(targetUrl)==0||page.indexOf(targetOrigin)==0&&window.contact_info==null){let nativeInputValueSetter=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,&quot;value&quot;).set;let setInputValue=function setInputValue(inputElem,str){nativeInputValueSetter.call(inputElem,str);inputElem.dispatchEvent(new Event(&quot;input&quot;,{bubbles:true}))};let nativeInputCheckedSetter=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,&quot;checked&quot;).set;let setInputChecked=function setInputChecked(inputElem,bool){nativeInputCheckedSetter.call(inputElem,bool);inputElem.dispatchEvent(new Event(&quot;input&quot;,{bubbles:true}))};window.addEventListener(&quot;message&quot;,function(msg){console.log(msg);if(msg.data==&quot;REQUEST_CONTACT_INFO&quot;){msg.source.postMessage({contact_info:window.contact_info})}else if(msg.data.contact_info!=null){let values=window.contact_info=msg.data.contact_info;for(let key in values){let element=document.querySelector(`input[name=&quot;${key}&quot;]`);setInputValue(element,values[key])}let van_name=null;[...document.scripts].forEach(x=>{let m=x.innerHTML.match(/van_name&quot;: &quot;([^&quot;]+)&quot;/);if(m&&m[1])van_name=m[1]});document.title=`${values.firstName}${values.lastName[0]} ${van_name}`;if(window.interval_id)clearInterval(window.interval_id)}});window.addEventListener(&quot;unload&quot;,function(){localStorage.clear()});let i=0;let postMsg=function(){window.opener.postMessage(&quot;REQUEST_CONTACT_INFO&quot;,&quot;*&quot;)};postMsg();window.interval_id=setInterval(function(){if(i++>120)clearInterval(window.interval_id);postMsg()},1e3);if(page.indexOf(targetUrl)==-1)setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},500);let firstCheckbox=document.querySelectorAll('input[type=&quot;checkbox&quot;]')[0];if(firstCheckbox&&firstCheckbox.checked)firstCheckbox.click();let showMore=document.querySelector('button[aria-controls=&quot;overflowTimeslots&quot;]');if(showMore&&showMore.getAttribute(&quot;aria-expanded&quot;)==&quot;false&quot;)showMore.click()}else setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},0)}catch(e){console.log(e)}})();">R05_GOTV_1A</a> Click bookmarklet once while on VAN VPB or Profile page, and once again once Mobilize opens to autofill contact info.</P>
<P><a draggable="true" href="javascript:(function(){try{let eventId=322476;let targetOrigin=&quot;https://www.mobilize.us&quot;,targetUrl=targetOrigin+&quot;/nvdems/event/&quot;+eventId+&quot;/&quot;,page=window.location.href,matches=page.match(/https:\/\/www\.(votebuilder.com\/(?:ContactsDetails|ContactDetailScript)|openvpb.com\/VirtualPhoneBank)/);let xpath=(xpathStr,root)=>{return document.evaluate(xpathStr,root||document,null,XPathResult.STRING_TYPE).stringValue};if(matches){let sitesxpaths={&quot;votebuilder.com/ContactDetailScript&quot;:{name:['//div[@class=&quot;person-phone-panel&quot;]/h1/span',/^(.*?) –.*/],email:['//*[contains(@id,&quot;EMailEmail_0&quot;)]'],phone:['//h1[@id=&quot;current-number&quot;]'],zip:['//span[@id=&quot;spanTableAdditionalInfo&quot;]//label[contains(.,&quot;Zip&quot;)]/following-sibling::div|//a[contains(@id,&quot;AddressesAddress&quot;)]',/.*\b(\d{5})(?:\D|$).*|.*/]},&quot;votebuilder.com/ContactsDetails&quot;:{name:['//*[contains(@id,&quot;ContactFullName&quot;)]'],email:['//span[@class=&quot;details-info-text&quot;]/a[contains(@id,&quot;EmailAddress&quot;)]'],phone:['//span[@class=&quot;details-info-text&quot;]/a[contains(@id,&quot;PhoneNumber&quot;)]'],zip:['//span[contains(@class,&quot;glyphicons-map-marker&quot;)]/..//a',/.*\b(\d{5})(?:\D|$).*|.*/]},&quot;openvpb.com/VirtualPhoneBank&quot;:{name:['//*[@id=&quot;contactName&quot;]'],email:['//*[@id=&quot;email-address-input&quot;]/@value'],phone:['//*[@id=&quot;openVpbPhoneLink&quot;]'],zip:['//*[@id=&quot;openvpb-target-details&quot;]//dt[contains(.,&quot;Zip&quot;)]/following-sibling::dd',/.*\b(\d{5})(?:\D|$).*|.*/]}};let xpaths=sitesxpaths[matches[1]];let values={};for(let key in xpaths){let[xp,repl]=xpaths[key];let val=xpath(xp).trim();if(repl)val=val.replace(repl,&quot;$1&quot;).trim();if(key==&quot;name&quot;){let parts=val.split(&quot; &quot;);values[&quot;firstName&quot;]=parts[0];values[&quot;lastName&quot;]=parts[parts.length-1]}else values[key]=val}window.addEventListener(&quot;message&quot;,function(msg){if(msg.origin==targetOrigin)msg.source.postMessage({contact_info:values},targetOrigin)});setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},100)}else if(page.indexOf(targetUrl)==0||page.indexOf(targetOrigin)==0&&window.contact_info==null){let nativeInputValueSetter=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,&quot;value&quot;).set;let setInputValue=function setInputValue(inputElem,str){nativeInputValueSetter.call(inputElem,str);inputElem.dispatchEvent(new Event(&quot;input&quot;,{bubbles:true}))};let nativeInputCheckedSetter=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,&quot;checked&quot;).set;let setInputChecked=function setInputChecked(inputElem,bool){nativeInputCheckedSetter.call(inputElem,bool);inputElem.dispatchEvent(new Event(&quot;input&quot;,{bubbles:true}))};window.addEventListener(&quot;message&quot;,function(msg){console.log(msg);if(msg.data==&quot;REQUEST_CONTACT_INFO&quot;){msg.source.postMessage({contact_info:window.contact_info})}else if(msg.data.contact_info!=null){let values=window.contact_info=msg.data.contact_info;for(let key in values){let element=document.querySelector(`input[name=&quot;${key}&quot;]`);setInputValue(element,values[key])}let van_name=null;[...document.scripts].forEach(x=>{let m=x.innerHTML.match(/van_name&quot;: &quot;([^&quot;]+)&quot;/);if(m&&m[1])van_name=m[1]});document.title=`${values.firstName}${values.lastName[0]} ${van_name}`;if(window.interval_id)clearInterval(window.interval_id)}});window.addEventListener(&quot;unload&quot;,function(){localStorage.clear()});let i=0;let postMsg=function(){window.opener.postMessage(&quot;REQUEST_CONTACT_INFO&quot;,&quot;*&quot;)};postMsg();window.interval_id=setInterval(function(){if(i++>120)clearInterval(window.interval_id);postMsg()},1e3);if(page.indexOf(targetUrl)==-1)setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},500);let firstCheckbox=document.querySelectorAll('input[type=&quot;checkbox&quot;]')[0];if(firstCheckbox&&firstCheckbox.checked)firstCheckbox.click();let showMore=document.querySelector('button[aria-controls=&quot;overflowTimeslots&quot;]');if(showMore&&showMore.getAttribute(&quot;aria-expanded&quot;)==&quot;false&quot;)showMore.click()}else setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},0)}catch(e){console.log(e)}})();">R05_GOTV_1B</a></P>
<p>Make your own with the event number at the end of a https://www.mobilize.us/nvdems/event/ URL<br>
	<input id="eventName" type="text" name="eventName" value="R05_Dialer">
	<input id="eventId" type="text" name="eventId" value="296095">
<a id="editLink" draggable href="javascript:(function(){try{let eventId=296095;let targetOrigin=&quot;https://www.mobilize.us&quot;,targetUrl=targetOrigin+&quot;/nvdems/event/&quot;+eventId+&quot;/&quot;,page=window.location.href,matches=page.match(/https:\/\/www\.(votebuilder.com\/(?:ContactsDetails|ContactDetailScript)|openvpb.com\/VirtualPhoneBank)/);let xpath=(xpathStr,root)=>{return document.evaluate(xpathStr,root||document,null,XPathResult.STRING_TYPE).stringValue};if(matches){let sitesxpaths={&quot;votebuilder.com/ContactDetailScript&quot;:{name:['//div[@class=&quot;person-phone-panel&quot;]/h1/span',/^(.*?) –.*/],email:['//*[contains(@id,&quot;EMailEmail_0&quot;)]'],phone:['//h1[@id=&quot;current-number&quot;]'],zip:['//span[@id=&quot;spanTableAdditionalInfo&quot;]//label[contains(.,&quot;Zip&quot;)]/following-sibling::div|//a[contains(@id,&quot;AddressesAddress&quot;)]',/.*\b(\d{5})(?:\D|$).*|.*/]},&quot;votebuilder.com/ContactsDetails&quot;:{name:['//*[contains(@id,&quot;ContactFullName&quot;)]'],email:['//span[@class=&quot;details-info-text&quot;]/a[contains(@id,&quot;EmailAddress&quot;)]'],phone:['//span[@class=&quot;details-info-text&quot;]/a[contains(@id,&quot;PhoneNumber&quot;)]'],zip:['//span[contains(@class,&quot;glyphicons-map-marker&quot;)]/..//a',/.*\b(\d{5})(?:\D|$).*|.*/]},&quot;openvpb.com/VirtualPhoneBank&quot;:{name:['//*[@id=&quot;contactName&quot;]'],email:['//*[@id=&quot;email-address-input&quot;]/@value'],phone:['//*[@id=&quot;openVpbPhoneLink&quot;]'],zip:['//*[@id=&quot;openvpb-target-details&quot;]//dt[contains(.,&quot;Zip&quot;)]/following-sibling::dd',/.*\b(\d{5})(?:\D|$).*|.*/]}};let xpaths=sitesxpaths[matches[1]];let values={};for(let key in xpaths){let[xp,repl]=xpaths[key];let val=xpath(xp).trim();if(repl)val=val.replace(repl,&quot;$1&quot;).trim();if(key==&quot;name&quot;){let parts=val.split(&quot; &quot;);values[&quot;firstName&quot;]=parts[0];values[&quot;lastName&quot;]=parts[parts.length-1]}else values[key]=val}window.addEventListener(&quot;message&quot;,function(msg){if(msg.origin==targetOrigin)msg.source.postMessage({contact_info:values},targetOrigin)});setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},100)}else if(page.indexOf(targetUrl)==0||page.indexOf(targetOrigin)==0&&window.contact_info==null){let nativeInputValueSetter=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,&quot;value&quot;).set;let setInputValue=function setInputValue(inputElem,str){nativeInputValueSetter.call(inputElem,str);inputElem.dispatchEvent(new Event(&quot;input&quot;,{bubbles:true}))};let nativeInputCheckedSetter=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,&quot;checked&quot;).set;let setInputChecked=function setInputChecked(inputElem,bool){nativeInputCheckedSetter.call(inputElem,bool);inputElem.dispatchEvent(new Event(&quot;input&quot;,{bubbles:true}))};window.addEventListener(&quot;message&quot;,function(msg){console.log(msg);if(msg.data==&quot;REQUEST_CONTACT_INFO&quot;){msg.source.postMessage({contact_info:window.contact_info})}else if(msg.data.contact_info!=null){let values=window.contact_info=msg.data.contact_info;for(let key in values){let element=document.querySelector(`input[name=&quot;${key}&quot;]`);setInputValue(element,values[key])}let van_name=null;[...document.scripts].forEach(x=>{let m=x.innerHTML.match(/van_name&quot;: &quot;([^&quot;]+)&quot;/);if(m&&m[1])van_name=m[1]});document.title=`${values.firstName}${values.lastName[0]} ${van_name}`;if(window.interval_id)clearInterval(window.interval_id)}});window.addEventListener(&quot;unload&quot;,function(){localStorage.clear()});let i=0;let postMsg=function(){window.opener.postMessage(&quot;REQUEST_CONTACT_INFO&quot;,&quot;*&quot;)};postMsg();window.interval_id=setInterval(function(){if(i++>120)clearInterval(window.interval_id);postMsg()},1e3);if(page.indexOf(targetUrl)==-1)setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},500);let firstCheckbox=document.querySelectorAll('input[type=&quot;checkbox&quot;]')[0];if(firstCheckbox&&firstCheckbox.checked)firstCheckbox.click();let showMore=document.querySelector('button[aria-controls=&quot;overflowTimeslots&quot;]');if(showMore&&showMore.getAttribute(&quot;aria-expanded&quot;)==&quot;false&quot;)showMore.click()}else setTimeout(function(){window.open(targetUrl,&quot;_blank&quot;)},0)}catch(e){console.log(e)}})();">R05_Dialer</a></p>



<p><a draggable="true" href="javascript:(function() {let vanID=document.querySelector(&quot;input[name='VanID']&quot;);window.open(&quot;https://www.votebuilder.com/&quot;+(vanID?&quot;ContactsDetails.aspx?VANID=&quot;+vanID.value:&quot;QuickLookUp.aspx&quot;),&quot;_blank&quot;)})()">Qlkup</a> Quick Look Up - open a VAN profile in a new tab for the person in the VPB.
</p>

<p><a draggable="true" href="javascript:(function(){let couldntReachBtn=document.querySelector(&quot;button.contact-toggle,section.tab-content button#switch&quot;);if(couldntReachBtn){couldntReachBtn.click();setTimeout(function(){let notHomeRadioBtn=document.querySelector('input[type=&quot;radio&quot;]');if(notHomeRadioBtn)notHomeRadioBtn.click()},50);setTimeout(function(){let saveAndNextBtnList=[...document.querySelectorAll('input[value=&quot;Save & Next Call&quot;], div.van-header-actions input[name*=&quot;TryNextNumber&quot;], #contactresultssavenextbutton')];let saveAndNextBtn=saveAndNextBtnList.filter(x=>x.offsetParent!=null)[0];if(saveAndNextBtn)saveAndNextBtn.click()},100)}})();">Not Home</a>In VPB, Mark as Not Home, Save and Next in a single click.
</p>
<script language="javascript">
	function updateBookmarklet(eventName,eventId){
		editLink.innerText=eventName;
		editLink.href=editLink.href.replace(/eventId=\d+;let/,'quot;eventId='+eventId+';let');
	}
	eventName.addEventListener("blur", e=>updateBookmarklet(eventName.value,eventId.value));
	eventName.addEventListener("change", e=>updateBookmarklet(eventName.value,eventId.value));
	eventName.addEventListener("keyup", e=>updateBookmarklet(eventName.value,eventId.value));
	eventId.addEventListener("blur", e=>updateBookmarklet(eventName.value,eventId.value));
	eventId.addEventListener("change", e=>updateBookmarklet(eventName.value,eventId.value));
	
	eventName.value="R05_Dialer";eventId.value="296095"
</script>
<body>
</html>
